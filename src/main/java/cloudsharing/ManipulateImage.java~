package test4and;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.sql.Connection;
import java.sql.Statement;

import org.apache.commons.codec.binary.Base64;
import static test4and.UtilityClass.getconnect;

public class ManipulateImage {

    // Decode String into an Image
    public static void convertStringtoImage(String encodedImageStr, String fileName ,String userName ,String FileMd5 )  {

        try {
            // Decode String using Base64 Class
            byte[] imageByteArray = Base64.decodeBase64(encodedImageStr);

            // Write Image into File system - Make sure you update the path
            FileOutputStream imageOutFile = new FileOutputStream(System.getenv("OPENSHIFT_DATA_DIR") + fileName);
            imageOutFile.write(imageByteArray);

            imageOutFile.close();
            
            
               Connection con = getconnect();
                Statement st = con.createStatement();
                boolean rs = st.execute("INSERT INTO tbl_upload VALUES('" + fileName + "','" + userName + "','" + FileMd5 +"')");
                con.close();

            System.out.println("File Successfully Stored");
        } catch (FileNotFoundException fnfe) {
            System.out.println("File Path not found" + fnfe);
        } catch (IOException ioe) {
            System.out.println("Exception while converting the File " + ioe);
        } catch (Exception e){
        
        e.printStackTrace();}

    }

}
